```sql
WITH CTE_ALL AS 
(
SELECT 
	E.*,
  	D.Name AS Dept_Name
FROM Employee AS E
LEFT OUTER JOIN Department AS D
ON E.DepartmentId = D.Id
)
SELECT * 
FROM (
SELECT 
Name, 
Dept_Name, 
Salary,
DENSE_RANK() over (PARTITION BY DepartmentId ORDER BY Salary DESC) as rr
FROM CTE_ALL
 ) as q 
 where rr = 1
 ```
